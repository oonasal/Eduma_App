(function(){angular.module("edumaApp",["ngRoute"]);function e(e,o){e.when("/",{redirectTo:"/login"}).when("/home",{templateUrl:"/views/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/views/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/views/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});o.html5Mode(true)}angular.module("edumaApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("edumaApp").controller("homeCtrl",e);e.$inject=["$location","authentication","edumaData","$http"];function e(e,o,n,t){var r=this;r.currentPath=e.path();r.isLoggedIn=o.isLoggedIn();r.currentUser=o.currentUser();r.logout=function(){o.logout();e.path("/login")};r.teachers=[];t.get("/api/users/teachers").then(function(e){console.log("data: "+e);console.log("teachers: "+e.data[0]);console.log("teachers: "+e.data);r.teachers=e.data;s()},function(e){console.log(e)});var a=0;r.currentTeacher={firstname:"",lastname:"",summary:"",email:"",age:"",location:""};function s(){console.log("teacher: "+r.teachers[a].firstname);console.log("teacher: "+r.teachers[a].lastname);console.log("teacher summary: "+r.teachers[a].summary);console.log("teacher email: "+r.teachers[a].email);r.currentTeacher={firstname:r.teachers[a].firstname,lastname:r.teachers[a].lastname,summary:r.teachers[a].summary,email:r.teachers[a].email,age:r.teachers[a].age,location:r.teachers[a].location};if(a===r.teachers.length){console.log("running out of teachers!");a=0}else{console.log("teacherCount: "+a);a++}}r.skipTeacher=function(){console.log("skipping teacher");s()}}})();(function(){angular.module("edumaApp").service("edumaData",e);e.$inject=["$http","authentication"];function e(e,o){}})();(function(){angular.module("edumaApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,o){console.log("called authentication service");var n=function(e){o.localStorage["eduma-token"]=e};var t=function(){return o.localStorage["eduma-token"]};register=function(o){var t=o.role;if(t==="teacher"){return e.post("/api/users/register/teachers",o).success(function(e){n(e.token)})}else{return e.post("/api/users/register/students",o).success(function(e){n(e.token)})}};login=function(o){var t=o.role;if(t==="teacher"){return e.post("/api/users/login/teachers",o).success(function(e){n(e.token)})}else{return e.post("/api/users/login/students",o).success(function(e){n(e.token)})}};logout=function(){o.localStorage.removeItem("eduma-token")};var r=function(){var e=t();if(e){var n=JSON.parse(o.atob(e.split(".")[1]));return n.exp>Date.now()/1e3}else{return false}};var a=function(){if(r()){var e=t();var n=JSON.parse(o.atob(e.split(".")[1]));return{email:n.email,firstname:n.firstname,lastname:n.lastname}}};return{currentUser:a,saveToken:n,getToken:t,isLoggedIn:r,logout:logout,login:login,register:register}}})();(function(){angular.module("edumaApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,o){var n=this;n.userinfo={firstname:"",lastname:"",email:"",password:"",role:"",location:"",age:"",summary:"",interest1:"",interest2:"",interest3:""};n.returnPage=e.search().page||"/login";n.onSubmit=function(){if(!n.userinfo.firstname||!n.userinfo.lastname||!n.userinfo.email||!n.userinfo.password||!n.userinfo.role){console.log("something was missing");console.log("first name: "+n.userinfo.firstname+", last name: "+n.userinfo.lastname+", email: "+n.userinfo.email+", password: "+n.userinfo.password+", role: "+n.userinfo.role+", location: "+n.userinfo.location);return false}else{console.log("first name: "+n.userinfo.firstname+", last name: "+n.userinfo.lastname+", email: "+n.userinfo.email+", password: "+n.userinfo.password+", role: "+n.userinfo.role+", location: "+n.userinfo.location);n.doRegister()}};n.doRegister=function(){o.register(n.userinfo).error(function(e){console.log("error")}).then(function(){console.log("registration successful");e.search("page",null);console.log("return page: "+n.returnPage);e.path(n.returnPage)})}}})();(function(){angular.module("edumaApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,o){var n=this;n.credentials={email:"",password:""};n.returnPage=e.search().page||"/home";n.onSubmit=function(){if(!n.credentials.email||!n.credentials.password){console.log("all fields required.");return false}else{n.doLogin()}};n.doLogin=function(){console.log("attempting to login");o.login(n.credentials).error(function(e){console.log("error.")}).then(function(){e.search("page",null);e.path(n.returnPage)})}}})();